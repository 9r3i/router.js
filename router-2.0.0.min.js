;function router(path,globEnv,head,foot){this.version='2.0.0';path=typeof path==='string'?path:'/';path=path.substr(0,1)!='/'?'/'+path:path;path+=path.substr(-1)!='/'?'/':'';this.basepath=path;this.baseurl=window.location.protocol+'//'+window.location.host+this.basepath;window._GLOBAL=typeof globEnv==='object'&&globEnv!==null?globEnv:{};this.headers=[];this.footers=[];head=Array.isArray(head)?head:[];foot=Array.isArray(foot)?foot:[];for(var i=0;i<head.length;i++){if(typeof head[i]==='function'){this.headers.push(head[i]);}}for(var i=0;i<foot.length;i++){if(typeof foot[i]==='function'){this.footers.push(foot[i]);}}this.routes=[];this.__proto__.addBunch=function(data){if(!Array.isArray(data)){return false;}for(var i=0;i<data.length;i++){this.add.apply(this.add,data[i]);}return true;};this.__proto__.add=function(path,title,content,select,funcs,env){path=typeof path==='string'?path:'';title=typeof title==='string'?title:'';content=typeof content==='string'?content:'';select=typeof select==='string'?select:'body';funcs=typeof funcs==='object'&&funcs!==null?funcs:{};env==typeof env==='object'&&env!==null?env:{};var output=[path,title];var newEnv={path:path,title:title,content:content,select:select,func:{},env:env,};for(var i in funcs){try{newEnv.func[i]=eval('(function(_get,_this,_env){'+funcs[i]+'})');}catch(e){console.error('Invalid function "'+i+'".');}}output.push(function(_get,_this,_env){window._ROUTER=_this;window._GET=_get;window._ENV=_env.env;window._FUNC=_env.func;if(Array.isArray(_this.headers)){for(var i=0;i<_this.headers.length;i++){if(typeof _this.headers[i]==='function'){_this.headers[i].call(_this.headers[i],_get,_this,_env);}}}if(_env.func.hasOwnProperty('header')&&typeof _env.func.header==='function'){_env.func.header(_get,_this,_env);}var newContent=_this.replace(_env.content);var el=document.querySelector(_env.select);if(el){el.innerHTML=newContent;}_this.anchor();if(_env.func.hasOwnProperty('footer')&&typeof _env.func.footer==='function'){_env.func.footer(_get,_this,_env);}if(Array.isArray(_this.footers)){for(var i=0;i<_this.footers.length;i++){if(typeof _this.footers[i]==='function'){_this.footers[i].call(_this.footers[i],_get,_this,_env);}}}});output.push(newEnv);return this.routes.push(output);};this.__proto__.anchor=function(){var ans=document.querySelectorAll('a:not([target="_blank"])');var _this=this;for(var i=0;i<ans.length;i++){ans[i].onclick=function(e){e.preventDefault();var href=this.getAttribute('href');if(typeof href!=='string'){return false;}var baseLength=_this.baseurl.length;var isBaseURL=href.substr(0,baseLength)===_this.baseurl?true:false;if(href.match(/^https?:\/\//i)&&!isBaseURL){return _this.go(href,true);}href=isBaseURL?href.substr(baseLength):href;return _this.go(href);};}return true;};this.__proto__.init=function(){var _this=this;if(window.hasOwnProperty('WINDOW_EVENTS')){WINDOW_EVENTS.onpopstate.push(function(){return _this.change();});WINDOW_EVENTS.execAll();}else{window.onpopstate=function(){return _this.change();};}var odef={path:window.location.pathname.substr(this.basepath.length),fullpath:path+window.location.search+window.location.hash};window.history.pushState(odef,odef.path,odef.fullpath);return this.change();};this.__proto__.change=function(){var path=window.location.pathname.substr(this.basepath.length);var fullpath=path+window.location.search+window.location.hash;return this.exec(fullpath);};this.__proto__.go=function(path,blank){blank=typeof blank==='boolean'?blank:false;if(blank){return window.location.assign(this.baseurl+path);}window.history.pushState({path:path,},path,this.basepath+path);return this.change();};this.__proto__.exec=function(path){path=typeof path==='string'?path:'';var p=path.split('?')[0];this.error(false);var r=this.route(p);if(typeof r!=='object'||r===null){var error='Not Found';this.title('404 '+error);return this.error(error,404);}if(!r.call||typeof r.call!=='function'){var error='Missing Function';this.title('400 '+error);return this.error(error,400);}if(typeof r.title==='string'){this.title(r.title);}var query=this.query(path.substr(p.length+1).split('#')[0]);return r.call.call(r.call,query,this,r.env);};this.__proto__.replace=function(c){c=typeof c==='string'?c:'';return c.replace(/\{\{[^(\}\})]+(\(\))?\}\}/ig,function(m){return eval(m);});};this.__proto__.title=function(s){s=typeof s==='string'?s:'';var t=document.getElementsByTagName('title');if(t.length>0){for(var i=0;i<t.length;i++){t[i].innerText=s;}}else{t=document.createElement('title');document.head.appendChild(t);t.innerText=s;}return true;};this.__proto__.route=function(p){var r=false;for(var i in this.routes){if(!Array.isArray(this.routes[i])||this.routes[i].length<3){continue;}if(typeof this.routes[i][0]==='string'&&typeof this.routes[i][1]==='string'&&typeof this.routes[i][2]==='function'&&this.routes[i][0]===p){var env={};if(typeof this.routes[i][3]==='object'&&this.routes[i][3]!==null){env=this.routes[i][3]}r={path:this.routes[i][0],title:this.routes[i][1],call:this.routes[i][2],env:env};break;}}return r;};this.__proto__.error=function(s,c){var id='router-error-statement';var n=document.getElementById(id);if(n){n.parentElement.removeChild(n);}if(s===false){return false;}s=typeof s==='string'?s:'Unknown Error';c=c%1===0?c:200;n=document.createElement('div');n.id=id;var sp=document.createElement('div');var sd=document.createElement('div');n.style.margin='0px';n.style.padding='30px';n.style.textAlign='center';n.style.position='fixed';n.style.zIndex=99999;n.style.top='0px';n.style.bottom='0px';n.style.left='0px';n.style.right='0px';n.style.backgroundColor='#eed';n.style.cursor='default';sp.style.textAlign='center';sp.style.color='#555';sp.style.fontSize='32px';sp.style.fontFamily='consolas,monospace';sp.innerText='Error: '+c.toString()+' '+s;sd.style.marginTop='30px';sd.style.textAlign='center';sd.style.color='#999';sd.style.fontSize='11px';sd.style.fontFamily='consolas,monospace';sd.innerText='9r3i\\router.js';n.appendChild(sp);n.appendChild(sd);document.body.appendChild(n);return true;};this.__proto__.query=function(t){if(typeof t!=='string'){return false;}var s=t.split('&');var r={},c={};for(var i in s){var p=s[i].split('=');var k=decodeURIComponent(p[0]);if(k.match(/\[(.*)?\]$/g)){var l=k.replace(/\[(.*)?\]$/g,'');var w=k.replace(/^.*\[(.*)?\]$/g,"$1");c[l]=c[l]?c[l]:0;if(w==''){w=c[l];c[l]+=1;}if(!r[l]){r[l]={};}r[l][w]=decodeURIComponent(p[1]);continue;}r[k]=p[1]?decodeURIComponent(p[1]):'';}return r;};this.__proto__.temp=function(){return false;};};